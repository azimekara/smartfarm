import{_ as t}from"./_tslib-6e8ca86b.js";import{r as e,a as o,D as n}from"./dropdowncomponents-f7289a07.js";import{D as i}from"./popupportal-a6998ee4.js";import{C as r}from"./custom-events-helper-18f7786a.js";import{P as s}from"./point-9c6ab88a.js";import{D as a,P as l,a as c,H as h,T as p}from"./dx-html-element-pointer-events-helper-0f2b6602.js";import{P as d,C as m,d as u,a as g,b as f,e as w,Z as b}from"./popup-99058cdb.js";import{n as y}from"./custom-element-bd7061f2.js";import{s as x,$ as v}from"./lit-element-b0a6fcba.js";import{e as P}from"./property-d3853089.js";import"./thumb-b78dcc42.js";import"./data-qa-utils-8be7c726.js";import"./eventhelper-8570b930.js";import"./rect-7fc5c2ef.js";import"./layouthelper-4b19d191.js";import"./events-interseptor-eeff27a3.js";import"./branch-2ea85171.js";import"./logicaltreehelper-15991dcb.js";import"./dom-166a04be.js";import"./rafaction-bba7928b.js";import"./transformhelper-ebad0156.js";import"./positiontracker-dba18a16.js";import"./capturemanager-91fa2b2d.js";import"./dx-ui-element-de378e9d.js";import"./lit-element-base-af247167.js";import"./nameof-factory-64d95f5b.js";var C,E,D,j;!function(t){t.Center="Center",t.Left="Left",t.Right="Right"}(D||(D={})),function(t){t.Top="Top",t.Center="Center",t.Bottom="Bottom"}(j||(j={}));let A=class extends i{};A=t([y("dxbl-window-dialog")],A);let S=class extends o{constructor(){super()}};S=t([y("dxbl-window-root")],S);class z{constructor(t,e){this.x=e.x,this.y=e.y}}class R extends CustomEvent{constructor(t,e){super(R.eventName,{detail:new z(t,e),bubbles:!0,composed:!0,cancelable:!1})}}R.eventName="dxbl-window.dragCompleted",r.register(R.eventName,(t=>t.detail));class T{constructor(t){this.x=t.x,this.y=t.y}}class N extends CustomEvent{constructor(t){super(N.eventName,{detail:new T(t),bubbles:!0,composed:!0,cancelable:!1})}}N.eventName="dxbl-window.dragStarted",r.register(N.eventName,(t=>t.detail));let B=C=class extends x{constructor(){super(),this.allowDrag=!1,this.pointerEventsHelper=new a(this)}connectedCallback(){super.connectedCallback();const t=this.closest("dxbl-window");if(!t)throw new Error("DxWindowHeader should be placed within a DxWindow");this.pointerEventsHelper.initialize(),this.allowDrag&&this.addEventListener(l.eventName,(e=>{const o=e,n=C.calculatePositionDelta(this,o.detail.source),i=C.createPoint(n,o.detail.source);let r=i;const s=()=>{t.positionX=r.x,t.positionY=r.y,a=requestAnimationFrame(s)};let a=requestAnimationFrame(s);const l=t=>{r=C.createPoint(n,t)};document.addEventListener("pointermove",l),this.addEventListener(c.eventName,(t=>{this.style.cursor="",this.style.userSelect="",cancelAnimationFrame(a),document.removeEventListener("pointermove",l);const e=C.createPoint(n,t.detail.source);this.shadowRoot.dispatchEvent(new R(i,e))}),{once:!0}),this.style.cursor="move",this.style.userSelect="none",this.shadowRoot.dispatchEvent(new N(i))}))}disconnectedCallback(){super.disconnectedCallback(),this.pointerEventsHelper.dispose()}get handlePointerEventsMode(){return h.Dragging}get handlePointerEventsTarget(){return this}get handlePointerEventsDelay(){return p}render(){return v`<slot></slot>`}static calculatePositionDelta(t,e){const o=t.getBoundingClientRect();return new s(Math.floor(e.clientX)-o.x,Math.floor(e.clientY)-o.y)}static createPoint(t,e){return new s(Math.floor(e.clientX)-t.x,Math.floor(e.clientY)-t.y)}};t([P({type:Boolean,attribute:"allow-drag",reflect:!1})],B.prototype,"allowDrag",void 0),B=C=t([y("dxbl-window-header")],B);let M=E=class extends n{constructor(){super(),this.sizeDirty=!1,this.positionYDirty=!1,this.positionXDirty=!1,this._settingsToApply=null,this.showAnchorElement=null,this.horizontalAlignment=D.Center,this.verticalAlignment=j.Center,this.closeOnEscape=!1,this.zIndex=0,this.placement=d.Custom}get positionY(){return this.offset.y}set positionY(t){this.positionYDirty=!0,this.offset=new s(this.positionX||0,t||0)}get positionX(){return this.offset.x}set positionX(t){this.positionXDirty=!0,this.offset=new s(t||0,this.positionY||0)}move(t){return new Promise(((e,o)=>{requestAnimationFrame((()=>{this._settingsToApply=t,this.forceReposition(),e()}))}))}showAt(t){return new Promise(((e,o)=>{this._settingsToApply=t,requestAnimationFrame((()=>{super.show(),e()}))}))}show(){this.showAt(this._settingsToApply).catch((t=>{}))}static getPlacementTarget(t){if(null!==t){if(null!==t.targetReference&&t.targetReference instanceof HTMLElement)return t.targetReference;if(null!==t.targetSelector){const e=document.querySelector(t.targetSelector);if(null!==e)return e}}return document.body}static getShowAtBox(t){return null===t?null:null!==t.targetReference&&t.targetReference instanceof HTMLElement?E.getElementTopLeftPoint(t.targetReference):null!==t.targetSelector?E.getElementTopLeftPoint(document.querySelector(t.targetSelector)):t.targetPoint}static getElementTopLeftPoint(t){if(null===t)return null;const e=t.getBoundingClientRect();return new s(e.left,e.top)}canProcessEscapeKeyDown(){return this.closeOnEscape}renderTemplate(){return v`
            <dxbl-branch
                id="branch"
                branch-id="${this.branchId}"
                parent-branch-id="${this.parentBranchId}"
                type="${this.branchType}"
                style="${this.dragCssStyle}">
                <dxbl-window-root
                    id="root"
                    style="${this.rootCssStyle}"
                    ?resizing="${this.resizing}"
                    drop-opposite="${this.actualDropOpposite}"
                    drop-direction="${this.actualDropDirection}"
                    drop-alignment="${this.actualDropAlignment}">
                    ${this.renderDefaultSlot()}
                    ${this.renderAdditionalSlots()}
                    ${this.renderBridgeSlot()}
                </dxbl-window-root>
            </dxbl-branch>
        `}raiseResizeCompleted(t,e){this.sizeDirty=!0,super.raiseResizeCompleted(t,e)}processCustomPlacement(t,e){if(this.positionXDirty||this.positionYDirty||this.isInDragOperation||this.sizeDirty)return null;const o=this._settingsToApply;return o?o.targetPoint?[new m(o.targetPoint,u.None,!1,g.Near,f.bottom)]:this.calcCustomPlacements(o):null}calcCustomPlacements(t){return[new m(this.calcShowPoint(t),u.None,!1,g.Near,f.bottom)]}calcShowPoint(t){const e=E.getPlacementTarget(t),o=this.getBoundingClientRect(),n=e.getBoundingClientRect(),i=document.body.getBoundingClientRect(),r=this.calcShowXPoint(o,n),a=this.calcShowYPoint(o,n),l=i.y+i.height-o.height;return new s(Math.max(0,r-Math.max(0,r-(i.x+i.width-o.width))),Math.max(0,a-Math.max(0,a-l)))}calcShowXPoint(t,e){return Math.floor((()=>{switch(this.horizontalAlignment){case D.Left:return e.x;case D.Right:return e.x+e.width-t.width;case D.Center:return e.x+e.width/2-t.width/2}throw new Error("calcShowXPoint not supported for horizontalAlignment:"+this.horizontalAlignment)})())}calcShowYPoint(t,e){return Math.floor((()=>{switch(this.verticalAlignment){case j.Top:return e.y;case j.Bottom:return e.y+e.height-t.height;case j.Center:return e.y+e.height/2-t.height/2}throw new Error("calcShowYPoint not supported for horizontalAlignment:"+this.verticalAlignment)})())}updated(t){super.update(t),t.has("zIndex")&&this.zIndex&&this.raiseZIndexChange()}raiseZIndexChange(){this.zIndex&&this.updateComplete.then((t=>{this.dispatchEvent(new w(new b(this.zIndex)))}))}};function X(t){if(!t)throw new Error("failed");return t}t([P({type:D,attribute:"horizontal-alignment",reflect:!1})],M.prototype,"horizontalAlignment",void 0),t([P({type:D,attribute:"vertical-alignment",reflect:!1})],M.prototype,"verticalAlignment",void 0),t([P({type:Number,attribute:"position-y",reflect:!1})],M.prototype,"positionY",null),t([P({type:Number,attribute:"position-x",reflect:!1})],M.prototype,"positionX",null),t([P({type:Boolean,attribute:"close-on-escape"})],M.prototype,"closeOnEscape",void 0),t([P({type:Number,attribute:"z-index"})],M.prototype,"zIndex",void 0),M=E=t([y("dxbl-window")],M);export{M as DxWindow,R as WindowDragCompletedEvent,N as WindowDragStartedEvent,X as getWindowRef};
